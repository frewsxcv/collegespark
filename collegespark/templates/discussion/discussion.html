{% extends "base.html" %}

{%block title %} 
   Welcome to Home page 
{% endblock %}

{% block css %}
   <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}/style/discussion/style.css">
{% endblock %}

{% block content %}
<div class="row-fluid discussion-bar">
   <div class="span3 new-post">
      <button class="btn btn-success">Create a New Post</button>
   </div>

   <div class="span9 discussion-search">
      <div class="input-append">
         <input class="input-xlarge" id="appendedInputButtons" type="text">

         <div class="btn-group">
            <button class="btn" tabindex="-1">Search</button>

            <button class="btn dropdown-toggle" data-toggle="dropdown" tabindex="-1">
               Options
               <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
               <li><a href="#">Department</a></li>
               <li><a href="#">Class</a></li>
               <li class="divider"></li>
               <li><a href="#">Separated link</a></li>
            </ul>
         </div>
      </div>  
   </div>

</div>

<div class="row-fluid">
   <div class="span12 category-table">
      <table class="table table-hover">
         <thead>
            <tr class="row">
               <th>#</th>
               <th>First Name</th>
               <th>Last Name</th>
            </tr>
         </thead>
         
         <tbody>
            <tr>
               <td>1</td>
               <td>Mark</td>
               <td>Otto</td>
               <td>@mdo</td>
            </tr>
            <tr>
               <td>2</td>
               <td>Jacob</td>
               <td>Thornton</td>
               <td>@fat</td>
            </tr>
            <tr>
               <td>3</td>
               <td colspan="2">Larry the Bird</td>
               <td>@twitter</td>
            </tr>
         </tbody>

      </table>

      <div class="pagination category-pagination">
         <ul>
            <li><a>Prev</a></li>
            <li><a>1</a></li>
            <li><a>2</a></li>
            <li><a>3</a></li>
            <li><a>4</a></li>
            <li><a>5</a></li>
            <li><a>Next</a></li>
         </ul>
      </div>

   </div>
</div>

<div class="row-fluid">
   <div class="span12 discussion-table">
      <table class="table table-hover">
         <thead>
            <tr>
               <th>#</th>
               <th>First Name</th>
               <th>Last Name</th>
               <th>Username</th>
            </tr>
         </thead>
         <tbody>
            <tr>
               <td>1</td>
               <td>Mark</td>
               <td>Otto</td>
               <td>@mdo</td>
            </tr>
            <tr>
               <td>2</td>
               <td>Jacob</td>
               <td>Thornton</td>
               <td>@fat</td>
            </tr>
            <tr>
               <td>3</td>
               <td colspan="2">Larry the Bird</td>
               <td>@twitter</td>
            </tr>
         </tbody>
      </table>

      <ul class="pager">
         <button class="btn previous disabled">&larr; Newer</button>
         <button class="btn next"> Older &rarr;</button>
      </ul>

   </div>
</div>

{% endblock %}

{% block script %}
   <script src="{{ STATIC_URL }}/js/discussion/discussion.js"></script>

   <script type="text/javascript">
      $(function () {
         var categories_count = {{categories_count}}
         var categories = new Category(categories_count);

         if (categories_count !== 0) {
            categories.get_categories(1);
            categories.set_category_pagination();
         } else {
            console.log("no categories")
         }

         console.log({{categories_count}})
         $(".category-pagination li").click(function(){
            var page = $(this).text().trim();
            console.log("Page is " + page);
            
            if (!isNaN(page)) {
               var page_num = parseInt(page, 10);

               if (categories.is_valid_page(page_num) &&
                  page_num !== categories.curr_page) {
                  categories.get_categories(page_num);
                  categories.curr_page = page_num;
               
               } else if (page_num !== categories.curr_page) {
                  categories.get_categories(categories.page_count)
                  categories.curr_page = categories.page_count;
               }
            
            } else {
               console.log("-----------")
               if (page === "Prev" && categories.has_prev()) {
                  categories.curr_page -= 1;
                  categories.get_categories(categories.curr_page);
               } else if (page === "Next" && categories.has_next()) {
                  categories.curr_page += 1;
                  categories.get_categories(categories.curr_page);                  
               }
            }

         });
      });
   </script>
{% endblock %}